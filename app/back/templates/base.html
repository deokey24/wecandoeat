<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>{% block title %}ê´€ë¦¬ìí˜ì´ì§€{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-100 min-h-screen flex flex-col">

  <div class="flex flex-1">

    {% set name = request.session.get("name") %}
    {% set username = request.session.get("username") %}
    {% set role = request.session.get("role", 0) %}
    {% set path = request.url.path %}

    {# ========== ì‚¬ì´ë“œë°” ========== #}
    {% if username %}
    <aside id="sidebar"
           class="fixed md:static top-0 left-0 z-40
                  w-56 md:w-60 h-full
                  bg-white border-r border-slate-200
                  flex flex-col
                  transform -translate-x-full md:translate-x-0
                  transition-transform duration-300">

      <div class="h-14 px-4 flex items-center justify-between border-b border-slate-100">
        <div class="text-sm font-semibold text-slate-800">
          {% if username %}
            {{ name }}ë‹˜
          {% else %}
            ë¡œê·¸ì¸ í•„ìš”
          {% endif %}
        </div>
        <button id="closeBtn" class="md:hidden text-xl leading-none">
          âœ•
        </button>
      </div>

      <nav class="flex-1 overflow-y-auto py-2 text-sm">
        <a href="/dashboard"
           class="flex items-center gap-2 px-4 py-2 rounded-md md:rounded-r-full
                  {% if path.startswith('/dashboard') %}
                    bg-blue-50 text-blue-600
                  {% else %}
                    text-slate-700 hover:bg-slate-50
                  {% endif %}">
          <span class="w-5 text-center">ğŸ </span>
          <span>í™ˆ</span>
        </a>

        {% if role >= 1 %}
        <div class="mt-4 mb-1 px-4 text-[11px] font-semibold text-slate-400">
          ê´€ë¦¬
        </div>

        <a href="/products"
           class="flex items-center gap-2 px-4 py-2 rounded-md md:rounded-r-full
                  {% if path.startswith('/products') %}
                    bg-blue-50 text-blue-600
                  {% else %}
                    text-slate-700 hover:bg-slate-50
                  {% endif %}">
          <span class="w-5 text-center">ğŸ“¦</span>
          <span>ìƒí’ˆê´€ë¦¬</span>
        </a>

        <a href="/stores"
           class="flex items-center gap-2 px-4 py-2 rounded-md md:rounded-r-full
                  {% if path.startswith('/stores') %}
                    bg-blue-50 text-blue-600
                  {% else %}
                    text-slate-700 hover:bg-slate-50
                  {% endif %}">
          <span class="w-5 text-center">ğŸ¬</span>
          <span>ì§€ì ê´€ë¦¬</span>
        </a>

        {% if role == 1 %}
        <a href="/users"
           class="flex items-center gap-2 px-4 py-2 rounded-md md:rounded-r-full
                  {% if path.startswith('/users') %}
                    bg-blue-50 text-blue-600
                  {% else %}
                    text-slate-700 hover:bg-slate-50
                  {% endif %}">
          <span class="w-5 text-center">ğŸ§¾</span>
          <span>ê¶Œí•œê´€ë¦¬</span>
        </a>
        {% endif %}

        <a href="/kiosks"
           class="flex items-center gap-2 px-4 py-2 rounded-md md:rounded-r-full
                  {% if path.startswith('/hardware') %}
                    bg-blue-50 text-blue-600
                  {% else %}
                    text-slate-700 hover:bg-slate-50
                  {% endif %}">
          <span class="w-5 text-center">ğŸ–¥ï¸</span>
          <span>í•˜ë“œì›¨ì–´ê´€ë¦¬</span>
        </a>

        <div class="mt-4 mb-1 px-4 text-[11px] font-semibold text-slate-400">
          ë§¤ì¶œ
        </div>

        <a href="/sales"
           class="flex items-center gap-2 px-4 py-2 rounded-md md:rounded-r-full
                  {% if path == '/sales' %}
                    bg-blue-50 text-blue-600
                  {% else %}
                    text-slate-700 hover:bg-slate-50
                  {% endif %}">
          <span class="w-5 text-center">ğŸ“ˆ</span>
          <span>ë§¤ì¶œ</span>
        </a>
        {% endif %}
      </nav>

      <div class="border-t border-slate-200 p-3 text-xs">
        {% if username %}
        <form action="/logout" method="post">
          <button class="w-full text-left text-slate-500 hover:text-red-500 hover:bg-red-50 px-3 py-2 rounded-lg">
            ë¡œê·¸ì•„ì›ƒ
          </button>
        </form>
        {% else %}
        <a href="/login" class="block text-slate-500 hover:text-blue-600 hover:bg-blue-50 px-3 py-2 rounded-lg">
          ë¡œê·¸ì¸
        </a>
        {% endif %}
      </div>
    </aside>
    {% endif %}

    {# ========== ë©”ì¸ ì˜ì—­ ========== #}
    <main class="flex-1 min-h-screen">
      <header class="md:hidden h-14 px-4 flex items-center justify-between bg-white border-b">
        <button id="menuBtn" class="text-xl">â˜°</button>
        <span class="text-sm font-semibold">ê´€ë¦¬ìí˜ì´ì§€</span>
      </header>

      <div class="p-4 md:p-8">
        {% block content %}{% endblock %}
      </div>
    </main>

  </div>

  {# ========== í‘¸í„° ========== #}
  {% block footer %}
<footer class="w-full bg-white border-t mt-8 py-3 text-center text-[12px] text-slate-600">
  (04585) ì„œìš¸ì‹œ ì¤‘êµ¬ ë‹¤ì‚°ë¡œ42ë‹¤ê¸¸ 28  
  ìƒí˜¸: ë”í‚¤  | ëŒ€í‘œ: ì„œí˜„ë• | ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸: 562-22-02323 <br>
  ê°œì¸ì •ë³´ë³´í˜¸ì±…ì„ì: ì„œí˜„ë• (deokey24@gmail.com)  
  ê³ ê°ì„¼í„°: 010-7715-3722
  <div class="mt-1">
    <a href="" class="hover:underline">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a> |
    <a href="" class="hover:underline">ì´ìš©ì•½ê´€</a>
  </div>
  <div class="mt-1 text-[11px]">Â© 2025 DEOKEY Corp. All rights reserved.</div>
</footer>
  {% endblock %}

  <script>
    const menuBtn = document.getElementById("menuBtn");
    const closeBtn = document.getElementById("closeBtn");
    const sidebar = document.getElementById("sidebar");

    function toggleSidebar() {
      if (sidebar.classList.contains("-translate-x-full")) {
        sidebar.classList.remove("-translate-x-full");
      } else {
        sidebar.classList.add("-translate-x-full");
      }
    }

    menuBtn?.addEventListener("click", toggleSidebar);
    closeBtn?.addEventListener("click", toggleSidebar);
  </script>

</body>
</html>
